async function attachPlugins(){$("select").each(function(){$(this).select2({tags:$(this).hasClass("tags"),createTag:function(t){var e=$.trim(t.term);return""===e?null:{id:e,text:"âœš "+e,newTag:!0}}})}),$("[data-flatpickr]").mrFlatpickr(),$(".start[data-flatpickr]").each(function(){$(this).flatpickr()&&$(this).flatpickr().config.onChange.push(function(t,e,a){var n=$(".end[data-flatpickr]").flatpickr();n&&(n.selectedDates.length&&Date.parse(n.selectedDates[0])<Date.parse(e)&&n.setDate(e),n.config.minDate=e)})}),LetterAvatar.transform(),$("[data-refresh]").each(function(){$(this).on("change",function(t){t.preventDefault(),url=$(this).data("refresh"),$.ajax({url:url,type:"GET",dataType:"text",method:"GET",data:$("form").serialize(),success:function(t,e,a){$(document).trigger("ajax:success",[t,e,a])},complete:function(t,e){$(document).trigger("ajax:complete",[t,e])},error:function(t,e,a){$(document).trigger("ajax:error",[t,e,a])}})})}),$(".summernote").each(function(){$(this).summernote({height:400})})}function PreviewAvatarImage(t,e,a){if(t.files&&t.files[0]){var n=new FileReader;n.onload=function(n){$(t).closest(".avatar-container").children(".avatar-preview").html('<img class="'+a+'" src="'+n.target.result+'" style="max-width:'+e+"px; max-height:"+e+'px;"/>')},n.readAsDataURL(t.files[0])}}function updateFilters(t,e,a,n,s,r,i){t=localStorage.getItem("sort"),e=localStorage.getItem("dir"),a=localStorage.getItem("filter"),n=localStorage.getItem("tag"),s=localStorage.getItem("select"),r=localStorage.getItem("from"),i=localStorage.getItem("until");var o=new URL(window.location.href);o.searchParams.has("sort")&&(t=o.searchParams.get("sort")),o.searchParams.has("dir")&&(e=o.searchParams.get("dir")),o.searchParams.has("filter")&&(a=o.searchParams.get("filter")),o.searchParams.has("tag")&&(n=o.searchParams.get("tag")),o.searchParams.has("select")&&(s=o.searchParams.get("select")),o.searchParams.has("from")&&(r=o.searchParams.get("from")),o.searchParams.has("until")&&(i=o.searchParams.get("until")),$(".filter-controls a").each(function(a){$(this).removeClass("asc desc"),$(this).data("sort")==t&&$(this).addClass(e)}),$(".filter-tags div").each(function(t){$(this).removeClass("active"),$(this).data("filter")==n&&$(this).addClass("active")}),$(".filter-input").each(function(t){$(this).val(a)}),$(".filter-select").each(function(t){$(this).val(s)}),$(".filter-from").each(function(t){flat=$(this).flatpickr(),flat&&flat.setDate(r)}),$(".filter-until").each(function(t){flat=$(this).flatpickr(),flat&&flat.setDate(i)})}function deleteFilters(){var t=new URL(window.location.href);t.searchParams.delete("sort"),t.searchParams.delete("dir"),t.searchParams.delete("filter"),t.searchParams.delete("tag"),t.searchParams.delete("select"),t.searchParams.delete("from"),t.searchParams.delete("until"),window.history.replaceState(null,null,t.href),updateFilters()}function loadContent(t){if(t.length){t.html('<div class="h-100 w-100 row align-items-center justify-content-center">\n            <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n            <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n            <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n            </div>');var e=new URL(window.location.href);$.ajax({url:e.href,type:"get",dataType:"text",data:{id:t.attr("id")},cache:!1}).done(function(e){t.html(e),LetterAvatar.transform();var a=new CustomEvent("paginate-load");document.dispatchEvent(a)}).fail(function(){})}}function initDropzoneLinks(t,e){$(".dropzone-file",$(".dz-preview").last()).each(function(){$(this).attr("href",e.download)}),$(".dropzone-delete",$(".dz-preview").last()).each(function(){$(this).attr("href",e.delete),$(this).removeClass("disabled")})}async function initDropzone(t,e,a,n){dropzone=$(t).dropzone({previewTemplate:document.querySelector(".dz-template").innerHTML,createImageThumbnails:!1,previewsContainer:t+"-previews",maxFiles:100,maxFilesize:10,parallelUploads:10,acceptedFiles:"image/*,text/*,font/*,application/*,.doc,.docx,.xls,.xlsx,.ppt,.pptx",url:e,success:function(t,e){e.is_success?(toastrs(lang.get("messages.dropzone.upload"),"success"),initDropzoneLinks(t,e),LetterAvatar.transform()):(this.removeFile(t),toastrs(lang.get("errors.dropzone.upload"),"danger"))},error:function(t,e){this.removeFile(t),toastrs(lang.get("errors.dropzone.upload"),"danger")},sending:function(t,e,a){a.append("_token",$('meta[name="csrf-token"]').attr("content"))},init:function(){if(n)for(var t in n){var e=n[t],a={name:e.file_name,size:e.size};this.options.addedfile.call(this,a),this.options.processing.call(this,a),this.options.complete.call(this,a),initDropzoneLinks(a,{download:e.download,delete:e.delete})}}})[0]}function onUpdateTimer(){$(".active-timer[data-timesheet="+window.timesheet+"]").each(function(){$(this).text(window.timerInstance.getTimeValues().toString())})}function timer(t,e,a){t&&(t.stop(),t.removeEventListener("secondsUpdated",onUpdateTimer),window.timesheet=a,t.addEventListener("secondsUpdated",onUpdateTimer),t.start({precision:"seconds",startValues:{seconds:e}}))}function updateTimerUI(t){$(".timer-popup").each(function(){$(this).replaceWith(t.popup)}),$(".timer-control").each(function(){$(this).replaceWith(t.control)}),$(".task").each(function(){$(this).removeClass("glow-animation")}),t.start&&t.task_id&&$(".task[data-id="+t.task_id+"]").addClass("glow-animation")}$(document).on("ajax:success",function(t,e,a,n){207==n.status?($("#modal").modal("hide"),e.url?window.location=e.url:window.location.reload()):n.responseText&&(n.responseText.includes("modal")?($("#modal").length||$("body").append($('<div class="modal show" id="modal" data-backdrop="static" data-keyboard="true"></div>')),$("#modal").html(n.responseText).modal("show"),attachPlugins()):window.location.reload())}),$(document).on("ajax:error",function(t,e,a,n){toastrs(n,"danger")}),function(t,e){function a(a,n){a=a||"",n=n||60;var s,r,i,o,l,c=String(a).toUpperCase().split(" ");return s=1==c.length?c[0]?c[0].charAt(0):"?":c[0].charAt(0)+c[1].charAt(0),t.devicePixelRatio&&(n*=t.devicePixelRatio),r=(("?"==s?72:s.charCodeAt(0))-64)%20,(i=e.createElement("canvas")).width=n,i.height=n,(o=i.getContext("2d")).fillStyle=["#92dacb","#e7afa9","#acd6f1","#e4c695","#93b4d8","#a3e4d7","#93d6af","#7fb2d4","#dab7e9","#a2cbf3","#dfce8c","#dfb999","#9fdfb9","#90c8db","#7db1b4","#dcb5eb","#e0b699","#e4a9a1","#83c1ee","#66b6db","#92dacb"][r],o.fillRect(0,0,i.width,i.height),o.font=Math.round(i.width/2)+"px Arial",o.textAlign="center",o.fillStyle="#FFF",o.fillText(s,n/2,n/1.5),l=i.toDataURL(),i=null,l}a.transform=function(){Array.prototype.forEach.call(e.querySelectorAll("img[avatar]"),function(t,e){e=t.getAttribute("avatar"),t.src=a(e,t.getAttribute("width")),t.removeAttribute("avatar"),t.setAttribute("alt",e)})},"function"==typeof define&&define.amd?define(function(){return a}):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=a),exports.LetterAvatar=a):(window.LetterAvatar=a,e.addEventListener("DOMContentLoaded",function(t){a.transform()}))}(window,document),$(function(){let t=null;$("body").on("click",".pagination a",function(e){e.preventDefault();var a=$(".paginate-container:visible");a.length&&(a.html('<div class="h-100 w-100 row align-items-center justify-content-center pt-3">\n                <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n                <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n                <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n                </div>'),clearTimeout(t),btn=$(this),t=setTimeout(function(){var t=new URL(window.location.href);sort=t.searchParams.get("sort"),dir=t.searchParams.get("dir"),filter=t.searchParams.get("filter");var e=new URL(btn.attr("href"));sort&&(e.searchParams.set("sort",sort),e.searchParams.set("dir",dir)),filter&&e.searchParams.set("filter",filter),$.ajax({url:e.href,type:"get",dataType:"text",data:{id:a.attr("id")}}).done(function(t){a.html(t),LetterAvatar.transform();var e=new CustomEvent("paginate-click");document.dispatchEvent(e)}).fail(function(){}),window.history.replaceState(null,null,e.href)},100))}),$(".filter-controls a").on("click",function(e){e.preventDefault();var a=$(".paginate-container:visible");a.length&&(a.html('<div class="h-100 w-100 row align-items-center justify-content-center pt-3">\n                <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n                <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n                <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n                </div>'),clearTimeout(t),btn=$(this),t=setTimeout(function(){var t=btn.data("sort"),e=btn.hasClass("asc")?"desc":"asc",n=new URL(window.location.href);n.searchParams.set("sort",t),n.searchParams.set("dir",e),$.ajax({url:n.href,type:"get",dataType:"text",data:{id:a.attr("id")}}).done(function(t){a.html(t),LetterAvatar.transform();var e=new CustomEvent("paginate-sort");document.dispatchEvent(e)}).fail(function(){}),window.history.replaceState(null,null,n.href),updateFilters()},100))}),$(".filter-tags div").on("click",function(e){e.preventDefault();var a=$(".paginate-container:visible");a.length&&(a.html('<div class="h-100 w-100 row align-items-center justify-content-center pt-3">\n                <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n                <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n                <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n                </div>'),clearTimeout(t),btn=$(this),t=setTimeout(function(){var t=btn.data("filter"),e=new URL(window.location.href);e.searchParams.get("tag")==t?e.searchParams.delete("tag"):e.searchParams.set("tag",t),$.ajax({url:e.href,type:"get",dataType:"text",data:{id:a.attr("id")}}).done(function(t){a.html(t),LetterAvatar.transform();var e=new CustomEvent("paginate-tag");document.dispatchEvent(e)}).fail(function(){}),window.history.replaceState(null,null,e.href),updateFilters()},100))}),$(".filter-input").on("input",function(e){e.preventDefault();var a=$(".paginate-container:visible");a.length&&(a.html('<div class="h-100 w-100 row align-items-center justify-content-center pt-3">\n                <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n                <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n                <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n                </div>'),clearTimeout(t),textInput=$(this),t=setTimeout(function(){var t=textInput.val(),e=new URL(window.location.href);t?e.searchParams.set("filter",t):e.searchParams.delete("filter"),$.ajax({url:e.href,type:"get",dataType:"text",data:{id:a.attr("id")}}).done(function(t){a.html(t),LetterAvatar.transform();var e=new CustomEvent("paginate-filter");document.dispatchEvent(e)}).fail(function(){}),window.history.replaceState(null,null,e.href)},500))}),$(".filter-select").on("change",function(e){e.preventDefault();var a=$(".paginate-container:visible");a.length&&(a.html('<div class="h-100 w-100 row align-items-center justify-content-center pt-3">\n                <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n                <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n                <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n                </div>'),clearTimeout(t),combo=$(this),t=setTimeout(function(){var t=combo.val(),e=new URL(window.location.href);t?e.searchParams.set("select",t):e.searchParams.delete("select"),$.ajax({url:e.href,type:"get",dataType:"text",data:{id:a.attr("id")}}).done(function(t){a.html(t),LetterAvatar.transform();var e=new CustomEvent("paginate-select");document.dispatchEvent(e)}).fail(function(){}),window.history.replaceState(null,null,e.href)},100))}),$(".filter-from").on("input",function(e){e.preventDefault();var a=$(".paginate-container:visible");a.length&&(a.html('<div class="h-100 w-100 row align-items-center justify-content-center pt-3">\n                    <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n                    <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n                    <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n                    </div>'),clearTimeout(t),textInput=$(this),t=setTimeout(function(){var t=textInput.val(),e=new URL(window.location.href);t?e.searchParams.set("from",t):e.searchParams.delete("from"),$.ajax({url:e.href,type:"get",dataType:"text",data:{id:a.attr("id")}}).done(function(t){a.html(t),LetterAvatar.transform();var e=new CustomEvent("paginate-from");document.dispatchEvent(e)}).fail(function(){}),window.history.replaceState(null,null,e.href)},500))}),$(".filter-until").on("input",function(e){e.preventDefault();var a=$(".paginate-container:visible");a.length&&(a.html('<div class="h-100 w-100 row align-items-center justify-content-center pt-3">\n                    <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n                    <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n                    <div class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div>\n                    </div>'),clearTimeout(t),textInput=$(this),t=setTimeout(function(){var t=textInput.val(),e=new URL(window.location.href);t?e.searchParams.set("until",t):e.searchParams.delete("until"),$.ajax({url:e.href,type:"get",dataType:"text",data:{id:a.attr("id")}}).done(function(t){a.html(t),LetterAvatar.transform();var e=new CustomEvent("paginate-until");document.dispatchEvent(e)}).fail(function(){}),window.history.replaceState(null,null,e.href)},500))})}),$(function(){$(document).on("click",".timer-entry",function(t){t.preventDefault();var e=$(this).attr("data-task"),a=$(this).attr("data-timesheet");$.ajax({url:$(this).attr("href"),type:"POST",data:{task_id:e,timesheet_id:a,_token:$('meta[name="csrf-token"]').attr("content")},success:function(t){t.start?timer(window.timerInstance,t.offset,t.timesheet_id):(window.timerInstance.stop(),window.timerInstance.removeEventListener("secondsUpdated",onUpdateTimer),t.url&&$.ajax({url:t.url,type:"get",dataType:"text",success:function(t,e,a){$(document).trigger("ajax:success",[t,e,a])},complete:function(t,e){$(document).trigger("ajax:complete",[t,e])},error:function(t,e,a){$(document).trigger("ajax:error",[t,e,a])}})),updateTimerUI(t)},error:function(t){}})})});
